{% import "shared/_display.html" as display_components %}
{% import "shared/_icons.html" as icon_components %}

{% macro stories(user, obj)%}
<title>{{obj.name | title}} - View Stories</title>

<div id="object-stories" class="grid-x">
    <div class="cell auto">
        <h2>
            View Stories
        </h2>
    </div>
    {% if user.world_user(obj)%}
    <div class="cell shrink">
        <button class="button small" hx-post="/story/new"
                hx-target="#stories-list"
                hx-selector="#stories-list"
                hx-swap="outerHTML">
            {{icon_components.plus(size="1rem")}}
            New Story
        </button>
    </div>
    {% endif %}
    <div id="story-details" class="cell">
        <div class="grid-x align-spaced">
            {% for story in obj.stories %}
            <div class="cell">
                <div class="callout ">
                    <a href="/story/{{story.pk}}">
                        <h3 class='text-center'>{{story.name}}</h3>
                    </a>
                    <div class="grid-x">
                        <div class="cell">
                            {% if story.image %}
                            <div class="float-left" style='margin: 1.5rem;'>
                                <img src='{{story.image.url(500)}}' alt='{{story.name}}'>
                            </div>
                            {% endif %}
                            <a href="/story/{{story.pk}}">
                                <div class='has-text-justified has-text-black'>
                                    {{story.summary | safe}}
                                </div>
                            </a>
                        </div>
                    </div>
                    <div class="callout">
                        <div class="grid-x align-spaced">
                            {%for ass in story.associations %}
                            <div class="cell medium-1">
                                {{display_components.object_display(ass, type=False, name=False)}}
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>
{%- endmacro %}