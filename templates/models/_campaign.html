{% import "models/_episode.html" as episode_components %}
{% import "shared/_icons.html" as icon_components %}
{% import "shared/_title.html" as title_components %}
{% import "shared/_history.html" as history_components %}
{% import "shared/_stories.html" as story_components %}
{% import "shared/_display.html" as display_components %}
{% import "manage/_campaign.html" as manage_campaign_components %}

{% macro index(user, campaign) -%}
<div class="row">
    <div class="column is-half">
        <h4 class="has-text-dark-grey has-text-center">
            Started: {{campaign.start_date if campaign.start_date else 'TBD'}}
        </h4>
    </div>
    <div class="column is-half">
        <h4 class="has-text-dark-grey has-text-center">
            Ended: {{campaign.end_date if campaign.end_date else 'TBD'}}
        </h4>
    </div>
    <div class="column is-full">
        <div class="panel has-bg-screen has-text-justified">
            {{campaign.description | safe}}
        </div>
    </div>
    <div class="column is-full">
        <div class="panel has-bg-muted">
            <hr>
            <div class='has-text-dark  has-text-justified generated-text-lightbg'>
                {{campaign.summary | safe}}
            </div>
            <hr>
        </div>
    </div>
</div>

<h3 class='has-text-center'>Episodes</h3>
<div class="row">
    {% for entry in campaign.episodes %}
    <div class="column is-full">
        <a href='/episode/{{entry.pk}}'>
            <div class="panel has-bg-muted">
                <div class="row" class='has-text-secondary'>
                    <div class="column is-vertically-centered">
                        <h4 class=' has-text-dark'>{{entry.name}}</h4>
                        <!-- {{entry.pk}} -->
                    </div>
                    <div class="column is-shrink">
                        {% if entry.start_date %}
                        <span class='tag is-primary has-text-white'>
                            {{entry.start_date}}
                        </span>
                        {% endif %}
                    </div>
                    <div class="column is-shrink">
                        {{icon_components.line()}}
                    </div>
                    <div class="column is-shrink">
                        {% if entry.end_date %}
                        <span class='tag is-primary has-text-white'>
                            {{entry.end_date}}
                        </span>
                        {% endif %}
                    </div>
                </div>
            </div>
        </a>
    </div>
    {% endfor %}
</div>
{%- endmacro %}

{% macro menu(user, obj) -%}
    <li><a href="/{{obj.path}}/history">{{icon_components.history(size="1rem")}} History</a></li>
    <li><a href="/{{obj.path}}/timeline">{{icon_components.timeline(size="1rem")}} Timeline</a></li>
    <li><a href="/{{obj.path}}/stories">{{icon_components.story(size="1rem")}} Stories</a></li>
{% endmacro %}

{% macro history(user, obj) -%}
{{history_components.history(user, obj)}}
{%- endmacro %}

{% macro associations(user, obj, associations) -%}

<h2 class=" has-text-secondary has-text-center is-subtitle">
    Associations</h2>
<div class="row">
    {% for o in associations %}
    <div class="column is-1 has-text-center">
        {{display_components.object_display(o, type=True)}}
    </div>
    {% endfor %}
</div>

{%- endmacro %}

{% macro manage(user, obj) -%}
{{ manage_campaign_components.manage(user, obj) }}
{%- endmacro %}

{% macro stories(user, obj)%}
{{story_components.stories(user, obj)}}
{%- endmacro %}