{% import "shared/_form.html" as form_components %}
{% import "shared/_history.html" as history_components %}
{% import "shared/_details.html" as details_components %}
{% import "shared/_journal.html" as journal_components %}
{% import "shared/_stories.html" as story_components %}
{% import "shared/_campaigns.html" as campaign_components %}
{% import "shared/_associations.html" as associations_components %}
{% import "shared/_display.html" as display_components %}
{% import "manage/_encounter.html" as manage_encounter_components %}
{% import "shared/_icons.html" as icon_components %}
{% import "shared/_title.html" as title_components %}


{% macro index(user, obj) -%}
{{details(user, obj)}}
{%- endmacro %}

{% macro menu(user, obj) -%}
<li>
    <a href=""
       hx-get="/api/{{obj.path}}/details" hx-target="#page-content"
       hx-indicator="#request-indicator" hx-swap="innerHTML show:#page-content:top"
       hx-push-url="/{{obj.path}}/details">
        <div class="grid-x">
            <div class="cell shrink">
                {{icon_components.details(size="1rem")}}
            </div>
            <div class="cell auto">
                <span>Details</span>
            </div>
        </div>
    </a>
</li>
<li>
    <a href="/{{obj.story.path}}">
        <div class="grid-x">
            <div class="cell shrink">
                {{icon_components.details(size="1rem")}}
            </div>
            <div class="cell auto">
                <span>Story</span>
            </div>
        </div>
    </a>
</li>
{%- endmacro %}

{% macro details(user, obj) -%}
<div class="grid-x align-spaced grid-margin-x">
    <div class="cell shrink">
        <div class="callout">
            <div class="grid-x">
                <div class="cell shrink align-center-middle">
                    <h4>Difficulty:</h4>
                </div>
                <div class="cell align-center-middle">
                    <h5 class='-grey'>{{obj.difficulty}}</h5>
                </div>
            </div>
        </div>
    </div>
    <div class="cell shrink">
        <div class="callout">
            <div class="grid-x">
                <div class="cell shrink align-center-middle">
                    <h4>Enemy Type:</h4>
                </div>
                <div class="cell align-center-middle">
                    <h5 class='-grey'>{{obj.enemy_type}}</h5>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="grid-x align-spaced grid-margin-x">
    <div class="cell medium-6">
        <div class="callout ">
            <div class="grid-x grid-margin-x">
                <div class="cell auto generated-text-lightbg">
                    <h3 class='text-center'>Backstory</h3>
                    {{obj.backstory | safe}}
                </div>
                {% if obj.image %}
                <div class="cell medium-3 generated-text-lightbg">
                    <img src="{{obj.image.url()}}" alt="Image for {{obj.name}}">
                </div>
                {% endif %}
            </div>
        </div>
    </div>
    <div class="cell medium-6">
        <div class="callout ">
            <h3>Triggers</h3>
            <span>
                {{obj.trigger_conditions | safe}}
            </span>
        </div>
    </div>
    <div class="cell">
        <div class="callout">
            <h5>Notes</h5>
            {{obj.notes | safe}}
        </div>
    </div>
</div>
<div class="grid-x">
    {% if user.world_user(obj)%}
    <div class="cell">
        <div class="callout">
            <h3>Mechanics</h3>
            {{obj.mechanics | safe}}
        </div>
    </div>
    {% if obj.enemies %}
    <div class="cell">
        <h3>Antagonists</h3>
        <div class="callout">
            <div class="grid-x align-spaced">
                {% for sd in obj.enemies %}
                <div class="cell medium-2">
                    {{display_components.object_display(sd, type=False)}}
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
    {% endif %}
    <div class="cell">
        <div class="callout ">
            <h3>Complications</h3>
            <span>
                {{obj.complications | safe}}
            </span>
        </div>
    </div>
    <div class="cell">
        <div class="callout">
            <h3>Potential Post Scenes</h3>
            <ul>
                {% for pc in obj.post_scenes %}
                <li>{{ pc | safe }}</li>
                {% endfor %}
            </ul>
        </div>
    </div>
    {% endif %}
</div>
{%- endmacro %}

{% macro stories(user, obj)%}
{{story_components.stories(user, obj)}}
{%- endmacro %}

{% macro associations(user, obj, associations)%}
{{associations_components.associations(user, obj, associations)}}
{%- endmacro %}

{% macro manage(user, obj) -%}
{{ manage_encounter_components.manage(user, obj) }}
{%- endmacro %}